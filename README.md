# Smog Dispersion Simulation: Jeżyce District

This project simulates air pollution dispersion in the Jeżyce district of Poznań. Instead of using random traffic generation, the simulation relies on real-world congestion data collected from the TomTom API and actual street geometry from OpenStreetMap.

---

<p align="center">
  <img src="0204-2.gif" alt="Smog Simulation Animation" width="700">
</p>
---

## Project Overview

The goal of this project was to create a realistic visualization of how traffic-related smog spreads across a specific urban area. The model moves away from theoretical assumptions and uses hard data to drive the simulation.

The visualization is built on a **Hybrid Model**:
* **Static Layer:** The road network is drawn once using precise vector data from OpenStreetMap. This acts as a permanent background, ensuring the city layout is always visible and accurate.
* **Dynamic Layer:** A pollution heatmap is overlaid on the streets. Its intensity and movement are calculated in real-time based on traffic levels, wind, and diffusion.

## How It Works

The system consists of three main components:

### 1. Traffic Data Collection
We developed a collector script that queried the **TomTom Traffic API** for 88 specific measurement points in Jeżyce (major intersections and key streets). This data was aggregated to create realistic, hourly congestion profiles (stored in `SREDNIE_KORKI.csv`). This allows the simulation to reflect actual peak hours and traffic jams.

### 2. Geometry & Mapping
The project uses **OSMnx** to retrieve the street network. A geo-spatial algorithm matches each road segment from the map to the nearest GPS measurement point (with an ~80m tolerance). This ensures that a specific street on the map "emits" pollution according to the real traffic data recorded for that location.

### 3. Physics Simulation
The dispersion model is based on **Cellular Automata** on a 2D grid. The state of each cell evolves based on:
* **Emission:** Generated by roads based on current traffic congestion.
* **Urban Background:** A base level of PM10 is added to represent general city pollution.
* **Advection (Wind):** The pollution cloud shifts according to the wind vector.
* **Diffusion:** Pollutants naturally spread to adjacent areas over time.

## Technologies Used

* **Python 3.9+**
* **NumPy:** For grid calculations and performance.
* **Matplotlib:** For rendering the animation and the hybrid map layers.
* **OSMnx & Shapely:** For handling geospatial data and map geometry.
* **Pandas:** For processing traffic data CSVs.

## How to Run

1.  Clone the repository:
    ```bash
    git clone [https://github.com/michalozminkowski/Smog-Dispersion-Simulation.git](https://github.com/michalozminkowski/Smog-Dispersion-Simulation.git)
    cd Smog-Dispersion-Simulation
    ```

2.  Install the required libraries:
    ```bash
    pip install numpy matplotlib osmnx pandas shapely scipy requests
    ```

3.  Run the simulation:
    ```bash
    python main.py
    ```

4.  (Optional) To collect new traffic data, configure your API key in `traffic_collector.py` and run it to update the CSV dataset.
